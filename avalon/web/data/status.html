<!DOCTYPE html>
<html>
<head>
    <title>Avalon Music Server</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <link rel="stylesheet" href="/avalon/css/all.min.css"/>
</head>
<body>

<div class="container">
    <div class="page-wrapper">
        <div class="page-header">
            <h1>Avalon Music Server <small>Server status</small></h1>
        </div>

        <div class="status ready">
            <div class="alert alert-success">
                <button type="button" class="close" data-dismiss="alert">&times;</button>
                Server is ready!
            </div>
        </div>

        <div class="status not-ready">
            <div class="alert alert-error">
                <button type="button" class="close" data-dismiss="alert">&times;</button>
                Server is <strong>not</strong> ready!
            </div>
        </div>

        <div id="content"></div>
    </div>
</div>

<script type="text/javascript" src="/avalon/js/all.min.js"></script>

<script type="text/template" id="status_template">
    <dl class="dl-horizontal">
        <dt>Server is:</dt>
        <dd>{{status}}</dd>

        <dt>Running as:</dt>
        <dd>{{user}}:{{group}}</dd>

        <dt>Uptime:</dt>
        <dd>{{uptime}}</dd>

        <dt>Memory:</dt>
        <dd>{{memory}} MB</dd>

        <dt>Threads:</dt>
        <dd>
            <ul class="unstyled">
                {{#threads}}
                <li>{{.}}</li>
                {{/threads}}
            </ul>
        </dd>

        <dt>Loaded:</dt>
        <dd>
            <ul class="unstyled">
                <li>Albums: {{albums}}</li>
                <li>Artists: {{artists}}</li>
                <li>Genres: {{genres}}</li>
                <li>Tracks: {{tracks}}</li>
            </ul>
        </dd>
        <dt>Search index size:</dt>
        <dd>{{trie_nodes}} nodes</dd>
    </dl>
</script>

<script type="text/javascript">
    // <![CDATA[
    $.get('/avalon/server', function (data) {
        $('body').removeClass('ready not-ready').addClass(data.status);
        var $template = $('#status_template'),
            $container = $('#content');

        $container.html(Mustache.render($template.text(), data));
    });
    //]]>
</script>
</body>
</html>
